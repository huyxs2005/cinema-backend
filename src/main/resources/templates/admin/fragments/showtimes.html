<section id="crud-showtimes" class="admin-tab-panel" th:fragment="showtimes-panel">
    <div class="row g-4">
        <div class="col-lg-4">
            <div class="card bg-dark text-light shadow">
                <div class="card-body">
                    <h3 class="h6 mb-3" id="showtimeFormTitle">Thêm suất chiếu</h3>
                    <form id="showtimeForm" novalidate>
                        <input type="hidden" id="showtimeId">
                        <div id="showtimeFormMessage" class="text-warning small mb-2"></div>
                        <div class="mb-3">
                            <input type="hidden" id="showtimeMovieId">
                            <div class="d-flex align-items-center gap-2 flex-wrap">
                                <label class="form-label mb-0">Phim <span class="text-danger">*</span></label>
                                <button type="button" class="btn btn-sm btn-outline-secondary" id="showtimeMovieClear">Xóa chọn</button>
                            </div>
                            <input type="text"
                                   id="showtimeMovieSearch"
                                   class="form-control mt-2"
                                   placeholder="Tìm kiếm tên phim hoặc tên gốc..."
                                   autocomplete="off">
                            <div class="movie-suggestion-list movie-suggestion-list--hidden" id="showtimeMovieSuggestions"></div>
                            <div class="movie-preview mt-3 movie-preview--hidden" id="showtimeMoviePreview"></div>
                            <div class="text-danger small mt-1" id="showtimeMovieError"></div>
                        </div>
                        <div class="mb-3">
                            <label for="showtimeAuditoriumId" class="form-label">Phòng chiếu <span class="text-danger">*</span></label>
                            <select id="showtimeAuditoriumId" class="form-select" required>
                                <option value="">-- Chọn phòng --</option>
                            </select>
                            <div class="text-danger small mt-1" id="showtimeAuditoriumError"></div>
                        </div>
                        <div class="mb-3">
                            <div class="showtime-datetime-wrapper">
                                <div class="row g-3 align-items-end">
                                    <div class="col-sm-6">
                                        <label for="showtimeStartDate" class="form-label">Ngày bắt đầu <span class="text-danger">*</span></label>
                                        <input type="date" id="showtimeStartDate" class="form-control" required>
                                        <div class="text-danger small mt-1" id="showtimeStartDateError"></div>
                                    </div>
                                    <div class="col-sm-6">
                                        <label for="showtimeStartTime" class="form-label">Giờ bắt đầu <span class="text-danger">*</span></label>
                                        <input type="time" id="showtimeStartTime" class="form-control" min="08:00" max="22:00" step="900" required>
                                        <div class="text-danger small mt-1" id="showtimeStartTimeError"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label mb-2">Khung giờ gợi ý</label>
                            <div class="showtime-time-suggestions" id="showtimeTimeSuggestions">
                                <button type="button" class="showtime-time-chip" data-time-suggestion="08:00">08:00</button>
                                <button type="button" class="showtime-time-chip" data-time-suggestion="09:30">09:30</button>
                                <button type="button" class="showtime-time-chip" data-time-suggestion="11:00">11:00</button>
                                <button type="button" class="showtime-time-chip" data-time-suggestion="13:30">13:30</button>
                                <button type="button" class="showtime-time-chip" data-time-suggestion="16:00">16:00</button>
                                <button type="button" class="showtime-time-chip" data-time-suggestion="18:30">18:30</button>
                                <button type="button" class="showtime-time-chip" data-time-suggestion="21:00">21:00</button>
                                <button type="button" class="showtime-time-chip" data-time-suggestion="22:00">22:00</button>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label d-block">Hiển thị</label>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="showtimeActive" checked>
                                <label class="form-check-label" for="showtimeActive">Kích hoạt</label>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="showtimeRepeatMode" class="form-label">Tạo cho</label>
                            <select id="showtimeRepeatMode" class="form-select">
                                <option value="NONE">Chỉ ngày đã chọn</option>
                                <option value="WHOLE_WEEK">Cả tuần (7 ngày)</option>
                                <option value="WEEKDAY">Các ngày trong tuần (T2 - T6)</option>
                                <option value="WEEKEND">Cuối tuần (T7 - CN)</option>
                                <option value="CUSTOM">Tùy chỉnh</option>
                            </select>
                            <div class="form-text text-muted">Mỗi suất sẽ bắt đầu đúng giờ bạn đã chọn.</div>
                        </div>
                        <div class="mb-3">
                            <label for="showtimeRepeatUntil" class="form-label">Lặp đến ngày</label>
                            <input type="date" id="showtimeRepeatUntil" class="form-control">
                            <div class="form-text text-light">Để trống nếu chỉ muốn tạo trong ngày vừa chọn.</div>
                            <div class="text-danger small mt-1" id="showtimeRepeatUntilError"></div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label mb-2">Ngày cụ thể</label>
                            <div class="d-flex flex-wrap gap-2" id="repeatDayButtons">
                                <button type="button" class="repeat-day-button" data-repeat-day="1">T2</button>
                                <button type="button" class="repeat-day-button" data-repeat-day="2">T3</button>
                                <button type="button" class="repeat-day-button" data-repeat-day="3">T4</button>
                                <button type="button" class="repeat-day-button" data-repeat-day="4">T5</button>
                                <button type="button" class="repeat-day-button" data-repeat-day="5">T6</button>
                                <button type="button" class="repeat-day-button" data-repeat-day="6">T7</button>
                                <button type="button" class="repeat-day-button" data-repeat-day="7">CN</button>
                            </div>
                        </div>
                        <div class="d-flex gap-2">
                            <button type="submit" class="btn btn-danger flex-grow-1">Lưu suất chiếu</button>
                            <button type="button" class="btn btn-outline-light" id="showtimeResetBtn">Làm mới</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <div class="col-lg-8">
            <div class="card bg-dark text-light shadow">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h2 class="h5 mb-0">Danh sách suất chiếu</h2>
                        <span class="badge bg-secondary" id="showtimeCount">0 suất</span>
                    </div>
                    <form id="showtimeFilterForm" class="mb-3">
                        <div class="row g-2 align-items-end mb-2">
                            <div class="col-xl-8 col-lg-7">
                                <input type="hidden" id="filterShowtimeMovie" name="movieId">
                                <div class="d-flex align-items-center gap-2 flex-wrap">
                                    <label class="form-label mb-0">Từ khóa phim</label>
                                    <button type="button" class="btn btn-sm btn-outline-secondary" id="filterShowtimeMovieClear">Xóa chọn</button>
                                </div>
                                <input type="text"
                                       class="form-control mt-2"
                                       id="filterShowtimeKeyword"
                                       placeholder="Tìm kiếm tên phim hoặc tên gốc..."
                                       autocomplete="off">
                            </div>
                            <div class="col-xl-4 col-lg-5 d-flex align-items-end gap-2 justify-content-lg-end flex-wrap flex-md-nowrap">
                                <button type="submit" class="btn btn-outline-light flex-grow-1 flex-lg-grow-0">Lọc</button>
                                <button type="button" id="showtimeFilterReset" class="btn btn-outline-secondary flex-grow-1 flex-lg-grow-0">Xóa</button>
                                <button class="btn btn-outline-light flex-grow-1 flex-lg-grow-0"
                                        type="button"
                                        data-bs-toggle="collapse"
                                        data-bs-target="#showtimeAdvancedFilters"
                                        aria-expanded="false"
                                        aria-controls="showtimeAdvancedFilters">
                                    Bộ lọc nâng cao
                                </button>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <div class="col-12 col-xl-8 col-lg-7">
                                <div class="movie-suggestion-list movie-suggestion-list--hidden" id="filterShowtimeMovieSuggestions"></div>
                                <div class="movie-preview mt-3 movie-preview--hidden" id="filterShowtimeMoviePreview"></div>
                                <div class="text-danger small mt-1" id="filterShowtimeMovieError"></div>
                            </div>
                        </div>
                        <div class="collapse" id="showtimeAdvancedFilters">
                            <div class="row g-2 align-items-end">
                                <div class="col-md-4">
                                    <label for="filterShowtimeAuditorium" class="form-label">Phòng chiếu</label>
                                    <select id="filterShowtimeAuditorium" class="form-select" name="auditoriumId">
                                        <option value="">Tất cả</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label for="filterShowtimeStatus" class="form-label">Trạng thái</label>
                                    <select id="filterShowtimeStatus" class="form-select" name="active">
                                        <option value="">Tất cả</option>
                                        <option value="true">Đang bật</option>
                                        <option value="false">Ngừng</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label for="filterShowtimeFrom" class="form-label">Từ ngày</label>
                                    <input type="date" id="filterShowtimeFrom" class="form-control" name="fromDate">
                                </div>
                                <div class="col-md-4">
                                    <label for="filterShowtimeTo" class="form-label">Đến ngày</label>
                                    <input type="date" id="filterShowtimeTo" class="form-control" name="toDate">
                                </div>
                            </div>
                        </div>
                    </form>
                    <div class="showtime-grouped-container" id="showtimeGroupedContainer">
                        <div class="showtime-empty-state">Chọn phim để xem lịch chiếu.</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
