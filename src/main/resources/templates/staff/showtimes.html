<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Suất chiếu hôm nay - Cinema HUB Staff</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/styles.css}">
    <link rel="stylesheet" th:href="@{/staff/staff-ui.css}">
</head>
<body class="staff-theme page-surface">
<th:block th:replace="~{fragments/header :: main}"></th:block>

<main class="content-shell staff-shell">
    <section class="staff-container staff-showtimes-page" id="staffShowtimesRoot"
             th:attr="data-showtimes-endpoint=@{/api/staff/showtimes},
                      data-booking-base=@{/staff/counter-booking},
                      data-default-date=${#temporals.format(#dates.createNow(), 'yyyy-MM-dd')}">
        <section class="staff-hero">
            <div>
                <p class="staff-eyebrow">Quản lý suất chiếu</p>
                <h1>Suất chiếu trong ngày</h1>
                <p>Theo dõi tình trạng ghế, chọn suất phòng và chuyển nhanh tới đặt vé.</p>
            </div>
            <div class="staff-stats">
                <div class="stat-chip">
                    <span>Tổng suất</span>
                    <strong id="showtimeCount">0</strong>
                </div>
                <div class="stat-chip">
                    <span>Số ghế đã bán</span>
                    <strong id="soldSeatCount">0</strong>
                </div>
                <div class="stat-chip">
                    <span>% lấp đầy TB</span>
                    <strong id="avgOccupancy">0%</strong>
                </div>
            </div>
        </section>

        <section class="staff-card filters-card">
            <form id="staffShowtimesFilter">
                <div class="filters-grid">
                    <label>
                        Ngày
                        <input id="filterDate" name="date" type="date">
                    </label>
                    <label>
                        Từ giờ
                        <input id="filterStartTime" name="startTime" type="time">
                    </label>
                    <label>
                        Đến giờ
                        <input id="filterEndTime" name="endTime" type="time">
                    </label>
                    <label>
                        Phim
                        <select id="filterMovie" name="movieId">
                            <option value="">Tất cả phim</option>
                        </select>
                    </label>
                    <label>
                        Phòng chiếu
                        <select id="filterAuditorium" name="auditoriumId">
                            <option value="">Tất cả phòng</option>
                        </select>
                    </label>
                    <label>
                        Trạng thái
                        <select id="filterStatus" name="status">
                            <option value="">Tất cả</option>
                            <option value="UPCOMING">Chưa chiếu</option>
                            <option value="RUNNING">Đang chiếu</option>
                            <option value="FINISHED">Đã kết thúc</option>
                        </select>
                    </label>
                </div>
                <div class="filters-actions">
                    <button class="secondary" type="button" id="resetFilterBtn">Đặt lại</button>
                    <button class="primary" type="submit">Tải danh sách</button>
                </div>
            </form>
        </section>

        <section class="table-card">
            <div class="table-responsive">
                <table class="showtimes-table">
                    <thead>
                    <tr>
                        <th>Phim</th>
                        <th>Phòng</th>
                        <th>Giờ chiếu</th>
                        <th class="text-center">Tổng ghế</th>
                        <th class="text-center">Ghế đã bán</th>
                        <th class="text-center">% lấp đầy</th>
                        <th></th>
                    </tr>
                    </thead>
                    <tbody id="staffShowtimesBody">
                    <tr>
                        <td colspan="7" class="text-center py-4 text-muted">
                            Đang tải dữ liệu suất chiếu...
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <p class="text-center mt-3" id="staffShowtimesEmpty" hidden>
                Không tìm thấy suất chiếu phù hợp.
            </p>
        </section>
    </section>
</main>

<th:block th:replace="~{fragments/footer :: main}"></th:block>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
<script th:src="@{/auth.js}"></script>
<script th:src="@{/staff/staff-showtimes.js}"></script>
</body>
</html>
