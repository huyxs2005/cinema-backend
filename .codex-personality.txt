From now on, follow ALL rules below STRICTLY. Do NOT ignore or relax any rule unless I explicitly say so.

======================================================
1. FILE HANDLING RULES
======================================================

1. Never delete existing files unless the user explicitly says:
   "Delete this file" or "Remove this file."
2. You may update existing files.
3. You may create new files.
4. If Vietnamese text becomes corrupted, fix the text. Do NOT delete the file.
5. All files must ALWAYS be written as UTF-8 without BOM.

======================================================
2. CMD + POWERSHELL RULES (UTF-8 SAFE ALWAYS)
======================================================

When generating ANY CMD commands that write text or scripts, use EXACTLY this pattern:

chcp 65001 >nul
powershell -NoProfile -Command ^
  "$OutputEncoding = [System.Text.Encoding]::UTF8; ^
   [Console]::OutputEncoding = [System.Text.Encoding]::UTF8; ^
   \$content = @'
(raw script or text here — Vietnamese OK)
'@; ^
   Set-Content -Path 'FILE_NAME_HERE' -Value \$content -Encoding UTF8"

STRICT RULES:
- Do NOT inline multi-line code inside a single -Command "...".
- Do NOT escape any quotes inside here-strings.
- Do NOT mix ", ', \", "" escaping.
- Always use PowerShell here-strings to hold raw text.
- Always write files using Set-Content -Encoding UTF8.
- Never generate nested or multi-layered PowerShell commands.

======================================================
3. PURE POWERSHELL RULES (NO CMD WRAPPER)
======================================================

Use ONLY this pattern:

$OutputEncoding = [System.Text.Encoding]::UTF8
[Console]::OutputEncoding = [System.Text.Encoding]::UTF8

$content = @"
(raw script or text here — Vietnamese OK)
"@

Set-Content -Path "FILE_NAME_HERE" -Value $content -Encoding UTF8

NEVER:
- escape quotes inside the here-string
- inline multi-line code inside a quoted string
- use Out-File without -Encoding UTF8

======================================================
4. UNIVERSAL SCRIPT-GENERATION RULES
======================================================

These rules ALWAYS apply:

1. Always write script content using a PowerShell here-string.
2. Never embed long or multi-line scripts inside a -Command string.
3. Never escape nested quotes inside here-strings.
4. Always write content first, then save file via Set-Content.
5. Always encode as UTF-8 without BOM.
6. Never use echo, >>, or default encoding for Vietnamese text.
7. Vietnamese text must always remain 100% intact.
8. Avoid nested PowerShell chains completely.
9. If a script is long, output it first normally, then wrap it in a here-string in a second step.

======================================================
5. FILE MODIFICATION STRATEGY (UNIFIED DIFF)
======================================================

When modifying existing code files:

1. Prefer unified diff (patch) format instead of rewriting entire files.
2. Use diffs like:

--- a/file.js
+++ b/file.js
@@ -24,7 +24,11 @@
- old code
+ new code

3. Modify files ONLY using unified diff format unless user requests full file.
4. Never rewrite entire files unless requested.
5. Split patches into smaller chunks if necessary.
6. If a diff cannot be safely generated, explain the limitation honestly.

======================================================
6. VIETNAMESE LANGUAGE RULES
======================================================

1. All Vietnamese must be correct, clean, and uncorrupted.
2. Do NOT change Vietnamese meanings unless user says so.
3. If Vietnamese becomes mojibake → fix the text, do NOT delete files.
4. When generating code containing Vietnamese text:
   - Always use here-strings for long or complex content.
   - Never escape quotes inside here-strings.
   - Preserve all Vietnamese accents exactly.

======================================================
7. CHAT LANGUAGE RULES
======================================================

1. UI text and validation messages → Vietnamese.
2. Technical explanations, architecture, debugging → English.
3. If both appear in same request:
   - Technical logic in English.
   - Display text in Vietnamese.

======================================================
8. ABSOLUTE MUST-FOLLOW RULES
======================================================

- Do NOT delete files unless explicitly told.
- Always use UTF-8 without BOM.
- Always use here-strings for scripts.
- Never escape quotes inside here-strings.
- Never inline multi-line scripts inside -Command.
- Never generate nested PowerShell commands.
- Preserve Vietnamese text perfectly.
- If Vietnamese breaks, fix it, do NOT delete file.
- CMD must always call chcp 65001 >nul before PowerShell.
- Always set $OutputEncoding and [Console]::OutputEncoding to UTF-8.
- Use unified diff patches for modifying existing files.
- Follow instructions literally and strictly.

======================================================

Acknowledge that you understand the rules, then wait for user instructions.

